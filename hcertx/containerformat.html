
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PrivacyCredentials is a generic credential system which is designed to be secure, privacy-preserving, scalable, performant and robust. It is designed specifically for some important use cases where physical, on-person verification of identity of holder is needed and where normal W3C Verifiable Credential flows are not fully suitable as they are normally designed currently.">
      
      
      
        <meta name="author" content="Jesus Ruiz">
      
      
        <link rel="canonical" href="https://hesusruiz.github.io/PrivacyCredentials/hcertx/containerformat.html">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.8">
    
    
      
        <title>EU DCC container - PrivacyCredentials</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.f1a3b89f.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="normal" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#electronic-health-certificate-container-format" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="PrivacyCredentials" class="md-header__button md-logo" aria-label="PrivacyCredentials" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PrivacyCredentials
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              EU DCC container
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/hesusruiz/PrivacyCredentials" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hesusruiz/PrivacyCredentials
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="PrivacyCredentials" class="md-nav__button md-logo" aria-label="PrivacyCredentials" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    PrivacyCredentials
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/hesusruiz/PrivacyCredentials" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hesusruiz/PrivacyCredentials
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Abstract
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Inroduction
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Inroduction" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Inroduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../features/features.html" class="md-nav__link">
        Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/privacy-architecture.html" class="md-nav__link">
        Architecture
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        HCERTX
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="HCERTX" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          HCERTX
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          EU DCC container
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="containerformat.html" class="md-nav__link md-nav__link--active">
        EU DCC container
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cbor-web-token-cwt" class="md-nav__link">
    CBOR Web Token (CWT)
  </a>
  
    <nav class="md-nav" aria-label="CBOR Web Token (CWT)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cwt-structure-overview" class="md-nav__link">
    CWT Structure Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signature-algorithm" class="md-nav__link">
    Signature Algorithm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-identifier" class="md-nav__link">
    Key Identifier
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issuer" class="md-nav__link">
    Issuer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expiration-time" class="md-nav__link">
    Expiration Time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issued-at" class="md-nav__link">
    Issued At
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#health-certificate-claim" class="md-nav__link">
    Health Certificate Claim
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transport-encodings" class="md-nav__link">
    Transport Encodings
  </a>
  
    <nav class="md-nav" aria-label="Transport Encodings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#raw" class="md-nav__link">
    Raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#barcode" class="md-nav__link">
    Barcode
  </a>
  
    <nav class="md-nav" aria-label="Barcode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#payload-cwt-compression" class="md-nav__link">
    Payload (CWT) Compression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qr-2d-barcode" class="md-nav__link">
    QR 2D Barcode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="datamodel.html" class="md-nav__link">
        EU DCC v1 data model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="trustedlists.html" class="md-nav__link">
        Trusted Lists
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="security-considerations.html" class="md-nav__link">
        Security
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        W3C Credentials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="W3C Credentials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          W3C Credentials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../credentials/w3c.html" class="md-nav__link">
        Data model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" data-md-state="indeterminate" type="checkbox" id="__nav_5" checked>
      
      <label class="md-nav__link" for="__nav_5">
        Trust Framework
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Trust Framework" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Trust Framework
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../trustframework/tf-overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../trustframework/smart-contracts.html" class="md-nav__link">
        Smart Contracts
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" data-md-state="indeterminate" type="checkbox" id="__nav_6" checked>
      
      <label class="md-nav__link" for="__nav_6">
        DID Methods
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DID Methods" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          DID Methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../didmethods/elsi.html" class="md-nav__link">
        ELSI
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" data-md-state="indeterminate" type="checkbox" id="__nav_7" checked>
      
      <label class="md-nav__link" for="__nav_7">
        Interoperability
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Interoperability" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Interoperability
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../interoperability/interoperability-eudcc.html" class="md-nav__link">
        with EUDCC
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../interoperability/interoperability-w3c.html" class="md-nav__link">
        with W3C
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../print_page.html" class="md-nav__link">
        Print
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cbor-web-token-cwt" class="md-nav__link">
    CBOR Web Token (CWT)
  </a>
  
    <nav class="md-nav" aria-label="CBOR Web Token (CWT)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cwt-structure-overview" class="md-nav__link">
    CWT Structure Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signature-algorithm" class="md-nav__link">
    Signature Algorithm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-identifier" class="md-nav__link">
    Key Identifier
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issuer" class="md-nav__link">
    Issuer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expiration-time" class="md-nav__link">
    Expiration Time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issued-at" class="md-nav__link">
    Issued At
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#health-certificate-claim" class="md-nav__link">
    Health Certificate Claim
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transport-encodings" class="md-nav__link">
    Transport Encodings
  </a>
  
    <nav class="md-nav" aria-label="Transport Encodings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#raw" class="md-nav__link">
    Raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#barcode" class="md-nav__link">
    Barcode
  </a>
  
    <nav class="md-nav" aria-label="Barcode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#payload-cwt-compression" class="md-nav__link">
    Payload (CWT) Compression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qr-2d-barcode" class="md-nav__link">
    QR 2D Barcode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="electronic-health-certificate-container-format">Electronic Health Certificate Container Format</h1>
<p>The Electronic Health Certificate Container Format (HCERT) is designed to provide a uniform and standardised vehicle for health certificates from different Issuers. The aim is to harmonise how these health certificates are represented, encoded and signed with the goal of facilitating interoperability.</p>
<p>When appropriate, we describe here the standard HCERT as used in the EU Digital COVID Certificate, and the extensions for the HCERTX certificate.</p>
<h2 id="cbor-web-token-cwt">CBOR Web Token (CWT)</h2>
<p>The certificate is structured and encoded as a CBOR with a COSE digital signature. This is commonly known as a "CBOR Web Token" (CWT), and is defined in <a href="https://tools.ietf.org/html/rfc8392">RFC 8392</a>. The actual health certificate data is transported in a <code>hcert</code> claim (as specified in <a href="https://www.iana.org/assignments/cwt/cwt.xhtml">CBOR Web Token (CWT) Claims</a>).</p>
<p>There may be in the future many types of Health Certificates transported in this <code>hcert</code> claim, but at this moment the EU Digital COVID Certificates (the three subtypes of Vaccination, test and Recovery), are assigned a sub-claim key <strong>1</strong> inside this 'hcert` claim.</p>
<p>The integrity and authenticity of origin of payload data MUST be verifiable by the Verifier. To provide this mechanism, the issuer MUST sign the CWT using an asymmetric electronic signature scheme as defined in the COSE specification (<a href="https://tools.ietf.org/html/rfc8152">RFC 8152</a>).</p>
<h3 id="cwt-structure-overview">CWT Structure Overview</h3>
<ul>
<li>
<p>Protected Header</p>
<ul>
<li>Signature Algorithm (<code>alg</code>, label <strong>1</strong>)</li>
<li>Key Identifier (<code>kid</code>, label <strong>4</strong>)</li>
</ul>
</li>
<li>
<p>Payload</p>
<ul>
<li>Issuer (<code>iss</code>, claim key <strong>1</strong>, optional, ISO 3166-1 alpha-2 of issuer)</li>
<li>Issued At (<code>iat</code>, claim key <strong>6</strong>)</li>
<li>Expiration Time (<code>exp</code>, claim key <strong>4</strong>)</li>
<li>
<p>Health Certificate (<code>hcert</code>, claim key <strong>-260</strong>)</p>
<ul>
<li>EU Digital Covid Certificate v1 (<code>eu_dcc_v1</code> aka <code>eu_dgc_v1</code>, claim key <strong>1</strong>)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Signature</p>
</li>
</ul>
<p>As mentioned before, the EU Digital Covid Certificate v1 travels <strong>inside</strong> the generic <code>hcert</code> claim, which is a registered IANA claim (<a href="https://www.iana.org/assignments/cwt/cwt.xhtml">CBOR Web Token (CWT) Claims</a>). But the <code>hcert</code> claim can be used to transport other Health Certificates in the future.</p>
<h3 id="signature-algorithm">Signature Algorithm</h3>
<p>The Signature Algorithm (<code>alg</code>) parameter indicates what algorithm is used for creating the signature. It must meet or exceed current SOG-IT guidelines.</p>
<p>One primary and one secondary algorithm is defined. The secondary algorithm should only be used if the primary algorithm is not acceptable within the rules and regulations imposed on the implementer.</p>
<p>However, it is essential and of utmost importance for the security of the system that all implementations incorporate the secondary algorithm. For this reason, both the primary and the secondary algorithm MUST be implemented.</p>
<p>For this version of the specification, the SOG-IT set levels for the primary and secondary algorithms are:</p>
<ul>
<li>Primary Algorithm: The primary algorithm is Elliptic Curve Digital Signature Algorithm (ECDSA) as defined in (ISO/IEC 14888–3:2006) section 2.3, using the P–256 parameters as defined in appendix D (D.1.2.3) of (FIPS PUB 186–4) in combination with the SHA–256 hash algorithm as defined in (ISO/IEC 10118–3:2004) function 4.</li>
</ul>
<p>This corresponds to the COSE algorithm parameter <code>ES256</code>.</p>
<ul>
<li>Secondary Algorithm: The secondary algorithm is RSASSA-PSS as defined in (<a href="https://tools.ietf.org/html/rfc8230">RFC 8230</a>) with a modulus of 2048 bits in combination with the SHA–256 hash algorithm as defined in (ISO/IEC 10118–3:2004) function 4.</li>
</ul>
<p>This corresponds to the COSE algorithm parameter: <code>PS256</code>.</p>
<h3 id="key-identifier">Key Identifier</h3>
<p>The Key Identifier (<code>kid</code>) claim is used by Verifiers for selecting the correct public key from a list of keys pertaining to the Issuer (<code>iss</code>) Claim. Several keys may be used in parallel by an Issuer for administrative reasons and when performing key rollovers. The Key Identifier is not a security-critical field. For this reason, it MAY also be placed in an unprotected header if required. Verifiers MUST accept both options.  If both options are present, the Key Identifier in the protected header MUST be used.</p>
<p>Due to the shortening of the identifier (for space-preserving reasons) there is a slim but non-zero chance that the overall list of DSCs accepted by a validator may contain DSCs with duplicate <code>kid</code>s. For this reason, a verifier MUST check all DSCs with that <code>kid</code>, until a successful verification is achieved. If no DSC succeeds, a validation error is raised.</p>
<h3 id="issuer">Issuer</h3>
<p>In HCERT, the Issuer (<code>iss</code>) claim is a string value that MAY optionally hold the ISO 3166-1 alpha-2 Country Code of the entity issuing the health certificate. This claim can be used by a Verifier to identify which set of DSCs to use for validation. The Claim Key 1 is used to identify this claim.</p>
<p>HCERTX supports the HCERT format but adds the possibility to use in <code>iss</code> the DID corresponding to the Issuer entity, with the W3C Verifiable Credentials format. On issuance the system uses the ELSI DID Method, as described later. On verification, the system can accept several DID Methods for resolution of the DID into the DID Document, most notably EBSI and AlastriaID. Resolution could be extended to any DID Method that provides a <strong>Universal Resolver interface</strong>. </p>
<h3 id="expiration-time">Expiration Time</h3>
<p>The Expiration Time (<code>exp</code>) claim SHALL hold a timestamp in the integer NumericDate format (as specified in <a href="https://tools.ietf.org/html/rfc8392">RFC 8392</a> section 2) indicating for how long this particular signature over the Payload SHALL be considered valid, after which a Verifier MUST reject the Payload as expired. The purpose of the expiry parameter is to force a limit of the validity period of the health certificate. The Claim Key 4 is used to identify this claim.</p>
<p>The Expiration Time MUST not exceed the validity period of the DSC.</p>
<h3 id="issued-at">Issued At</h3>
<p>The Issued At (<code>iat</code>) claim SHALL hold a timestamp in the integer NumericDate format (as specified in <a href="https://tools.ietf.org/html/rfc8392">RFC 8392</a> section 2) indicating the time when the health certificate was created. </p>
<p>The Issued At field MUST not predate the validity period of the DSC.</p>
<p>Verifiers MAY apply additional policies with the purpose of restricting the validity of the health certificate based on the time of issue. The Claim Key 6 is used to identify this claim.</p>
<h3 id="health-certificate-claim">Health Certificate Claim</h3>
<p>The Health Certificate (<code>hcert</code>) claim is a JSON (<a href="https://tools.ietf.org/html/rfc7159">RFC 7159</a>) object containing the health status information, represented in CBOR as a <em>map</em>. It is registered as claim key <strong>-260</strong> in the IANA claim registry (<a href="https://www.iana.org/assignments/cwt/cwt.xhtml">CBOR Web Token (CWT) Claims</a>). Several different types of health certificate MAY exist under the same claim, of which the European Digital COVID Certificate is one.</p>
<p>Note here that the JSON is purely for schema purposes. The wire format is CBOR as defined in (<a href="https://tools.ietf.org/html/rfc7049">RFC 7049</a>). Application developers may not actually ever decode or encode to and from the JSON format, but use the in-memory structure.</p>
<p>Strings in the JSON object SHOULD be <a href="http://www.unicode.org/reports/tr15/#Norm_Forms">NFC normalised according to the Unicode standard</a>. Decoding applications SHOULD however be permissive and robust in these aspects, and acceptance of any reasonable type conversion is strongly encouraged. If non-normalised data is found during decoding, or in subsequent comparison functions, implementations SHOULD behave as if the input is normalised to NFC.</p>
<h2 id="transport-encodings">Transport Encodings</h2>
<h3 id="raw">Raw</h3>
<p>For arbitrary data interfaces the HCERT container and its payloads may be transferred as-is, utilising any underlying, 8 bit safe, reliable data transport. These interfaces MAY include NFC, Bluetooth or transfer over an application layer protocol, for example transfer of an HCERT from the Issuer to a holder’s mobile device.</p>
<p>If the transfer of the HCERT from the Issuer to the holder is based on a presentation-only interface (e.g., SMS, e-mail), the Raw transport encoding is obviously not applicable.</p>
<h3 id="barcode">Barcode</h3>
<figure class="figure-image">
  <img src="container_overview.png" alt="Overview: QR code generation and verification">
  <figcaption>Overview: QR code generation and verification</figcaption>
</figure>

<h4 id="payload-cwt-compression">Payload (CWT) Compression</h4>
<p>To lower size and to improve speed and reliability in the reading process of the HCERT, the CWT SHALL be compressed using ZLIB (<a href="https://tools.ietf.org/html/rfc1950">RFC 1950</a>) and the Deflate compression mechanism in the format defined in (<a href="https://tools.ietf.org/html/rfc1951">RFC 1951</a>). </p>
<h4 id="qr-2d-barcode">QR 2D Barcode</h4>
<p>In order to better handle legacy equipment designed to operate on ASCII payloads, the compressed CWT is encoded as ASCII using <a href="https://datatracker.ietf.org/doc/draft-faltstrom-base45">Base45</a> before being encoded into a 2D barcode.</p>
<p>The QR format as defined in (<a href="https://www.iso.org/standard/62021.html#:~:text=ISO%2FIEC%2018004%3A2015%20defines%20the%20requirements%20for%20the%20symbology,algorithm%2C%20production%20quality%20requirements%2C%20and%20user-selectable%20application%20parameters.">ISO/IEC 18004:2015</a>) SHALL be used for 2D barcode generation. An error correction rate of ‘Q’ (around 25%) is RECOMMENDED.  The Alphanumeric (Mode 2/QR Code symbols 0010) MUST be used in conjunction with Base45. </p>
<p>In order for Verifiers to be able to detect the type of data encoded and to select the proper decoding and processing scheme, the base45 encoded data (as per this specification) SHALL be prefixed by the Context Identifier string <code>HC1:</code>. Future versions of this specification that impact backwards-compatibility SHALL define a new Context Identifier, whereas the character following <code>HC</code> SHALL be taken from the character set [1-9A-Z]. The order of increments is defined to be in that order, i.e., first [1-9] and then [A-Z].</p>
<p>The optical code is RECOMMENDED to be rendered on the presentation media with a diagonal size between 35 mm and 60 mm to accommodate readers with fixed optics where the presentation media is required to be placed on the surface of the reader.</p>
<p>If the optical code is printed on paper using low-resolution (&lt; 300 dpi) printers, care must be taken to represent each symbol (dot) of the QR code exactly square. Non-proportional scaling will result in some rows or columns in the QR having rectangular symbols, which will hamper readability in many cases.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        <!--
  Copyright (c) 2016-2021 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->



<!-- Footer -->
<footer class="md-footer">
  <!-- Link to previous and/or next page -->
  
  <nav
    class="md-footer__inner md-grid"
    aria-label="Footer"
  >
    <!-- Link to previous page -->
     
    <a
      href="overview.html"
      class="md-footer__link md-footer__link--prev"
      aria-label="Previous: Overview"
      rel="prev"
    >
      <div class="md-footer__button md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </div>
      <div class="md-footer__title">
        <div class="md-ellipsis">
          <span class="md-footer__direction"> Previous </span>
          Overview
        </div>
      </div>
    </a>
    

    <!-- Link to next page -->
     
    <a
      href="datamodel.html"
      class="md-footer__link md-footer__link--next"
      aria-label="Next: EU DCC v1 data model"
      rel="next"
    >
      <div class="md-footer__title">
        <div class="md-ellipsis">
          <span class="md-footer__direction"> Next </span>
          EU DCC v1 data model
        </div>
      </div>
      <div class="md-footer__button md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
      </div>
    </a>
    
  </nav>
  

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <!-- Copyright and theme information -->
      <div class="md-footer-copyright">
        <div class="md-footer-copyright__highlight">
          <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
            <img
              alt="Creative Commons License"
              style="border-width: 0"
              src="https://i.creativecommons.org/l/by/4.0/88x31.png"
            /> </a
          ><br />This work is licensed under a
          <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"
            >Creative Commons Attribution 4.0 International License</a
          >. Made with
          <a
            href="https://squidfunk.github.io/mkdocs-material/"
            target="_blank"
            rel="noopener"
          >
            Material for MkDocs
          </a>
        </div>
      </div>

      <!-- Social links -->
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.expand"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.b0710199.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.76f349be.min.js"></script>
      
        <script src="../js/print-site-instant-loading.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>