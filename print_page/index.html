
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PrivacyCredentials is a generic credential system which is designed to be secure, privacy-preserving, scalable, performant and robust. It is designed specifically for some important use cases where physical, on-person verification of identity of holder is needed and where normal W3C Verifiable Credential flows are not fully suitable as they are normally designed currently.">
      
      
      
        <meta name="author" content="Jesus Ruiz">
      
      
        <link rel="canonical" href="https://hesusruiz.github.io/PrivacyCredentials/print_page/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.8">
    
    
      
        <title>Print - PrivacyCredentials</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.f1a3b89f.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="normal" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PrivacyCredentials" class="md-header__button md-logo" aria-label="PrivacyCredentials" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PrivacyCredentials
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/hesusruiz/PrivacyCredentials" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hesusruiz/PrivacyCredentials
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PrivacyCredentials" class="md-nav__button md-logo" aria-label="PrivacyCredentials" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    PrivacyCredentials
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/hesusruiz/PrivacyCredentials" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hesusruiz/PrivacyCredentials
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Requirements
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Requirements" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Requirements
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../requirements/requirements/" class="md-nav__link">
        Requirements
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Architecture
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Architecture" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Architecture
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/ar-overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/relationship-with-eucovid/" class="md-nav__link">
        Relationship with EU COVID
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        DID Methods
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DID Methods" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          DID Methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../didmethods/elsi/" class="md-nav__link">
        ELSI
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" data-md-state="indeterminate" type="checkbox" id="__nav_5" checked>
      
      <label class="md-nav__link" for="__nav_5">
        Credentials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Credentials" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Credentials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../credentials/eu-covid/" class="md-nav__link">
        EU COVID
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../credentials/w3c/" class="md-nav__link">
        W3C VC
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" data-md-state="indeterminate" type="checkbox" id="__nav_6" checked>
      
      <label class="md-nav__link" for="__nav_6">
        Trust Framework
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Trust Framework" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Trust Framework
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../trustframework/tf-overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../trustframework/smart-contracts/" class="md-nav__link">
        Smart Contracts
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Print
      </a>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <div id="print-site-page" class="print-site-enumerate-figures">
        <section id="print-site-cover-page">
            
<div style="padding-bottom: 3em">

    
        <h1>PrivacyCredentials</h1>
    

    
        <h2>PrivacyCredentials is a generic credential system which is designed to be secure, privacy-preserving, scalable, performant and robust. It is designed specifically for some important use cases where physical, on-person verification of identity of holder is needed and where normal W3C Verifiable Credential flows are not fully suitable as they are normally designed currently.</h2>
    

</div>


    <p>Authors: Jesus Ruiz</p>


<p>
    
        <small>Website: <a href="https://hesusruiz.github.io/PrivacyCredentials/">https://hesusruiz.github.io/PrivacyCredentials/</a></small><br />
    
    
        <small>Repo: <a href="https://github.com/hesusruiz/PrivacyCredentials">https://github.com/hesusruiz/PrivacyCredentials</a></small><br />
    
    
        <small>Copyright &copy; 2021</small><br />
    
</p>
        </section>
        
        <div id="print-site-banner">
            <p>
    <em>This box will disappear when printing</em>
    <span style="float: right"><a href="https://timvink.github.io/mkdocs-print-site-plugin/">mkdocs-print-site-plugin</a></span>
</p>
<p>This page combines all site pages and applies print and PDF friendly styling. Print or export to PDF using <b>File > Print > Save as PDF</b>.</p>
<p>For creating PDFs, make sure to use the browser's print and save-as-pdf function instead of the system dialog.</p>
        </div>
        
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="6">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-introduction">Introduction</h1>
<p><strong>PrivacyCredentials</strong> is a generic credential system which is designed to be secure, privacy-preserving, scalable, performant and robust. It is designed specifically for some important use cases where physical, on-person verification of identity of holder is needed and where normal W3C Verifiable Credential flows are not fully suitable as they are normally designed currently.</p>
<p>The system is designed to support credentials in different formats, initially the <a href="https://www.w3.org/TR/vc-data-model/">W3C Verifiable Credential</a> format and the <strong>HCERT</strong> format used in the <a href="https://ec.europa.eu/info/live-work-travel-eu/coronavirus-response/safe-covid-19-vaccines-europeans/eu-digital-covid-certificate_en">EU Digital COVID Certificate</a> system for health certificates in the EU.</p>
<p>It enables production implementations today, because it is designed to be compatible with all current regulations in place today in the European Union (and many other regions of the world).</p>
<p>This document describes the overall architecture of the system, including the credential formats, interaction among the actor involved and the Trust Framework which it implements.</p>
<p>Special focus is put on privacy of personal data in real-life scenarios like health-related credentials.</p></section><h1 class='nav-section-title'>Requirements</h1><section class="print-page" id="requirements-requirements"><h1 id="requirements-requirements-requirements">Requirements</h1>
<p>The system supports the life cycle of a certificate:</p>
<ol>
<li>the collection and registration of data about the citizen and her associated characteristics,  </li>
<li>the issuance of a certificate, and  </li>
<li>the presentation of the certificate to a verifier for its verification.</li>
</ol>
<p>The verifier of a certificate should be able to establish that: </p>
<ul>
<li>The certificate has been issued by an entity which is authorised to issue that specific type of certificate; </li>
<li>The information presented on the certificate is authentic, valid, and has not been altered; </li>
<li>The certificate can be linked to the holder of the certificate;</li>
</ul>
<p>More detailed requirements are the following.</p>
<h2 id="requirements-requirements-data-protection-including-data-minimisation-purpose-limitation-etc">Data protection (including data minimisation, purpose limitation, etc.)</h2>
<p>The system should protect the data of the involved natural persons, especifically certificate holders. This covers several principles expressed in the GDPR, including purpose limitation and data minimisation (<a href="https://gdpr.eu/article-5-how-to-process-personal-data/">Articles 5.1.b and 5.1.c of GDPR</a>). In particular, this implies the usage of a minimum set of data in the certificates as required for the supported use cases (data minimisation).</p>
<p>Importantly, this also implies that no personal data is registered in the blockchain. Not even a hash of the certificate is ever registered in the blockchain, because it is not required and it may be in violation of the purpose limitation principle.</p>
<p>The same applies to the act of presentation of the credential to a specific verifier (data minimisation) and the purpose of data presentation should be checked against the use cases (purpose limitation).</p>
<h2 id="requirements-requirements-id-binding-and-verification">ID binding and verification</h2>
<p>The system follows the principles laid out in the eHealth Interoperability documents and generalises them to <strong>any type of credential</strong> and any type of use case where they can be applied.</p>
<p>ID binding refers to the mechanisms used to associate or bind the real identity of a subject and the certificate. The identity of this subject shall be bound to a certificate when the certificate is issued (ID binding) and has to be verified when the certificate is being presented and verified (ID verification). These two processes (ID binding at the Issuance step and ID verification at the Presentation and Verification step) prevent possible impersonation attempts, and are in line with the data security and privacy by design and default principles of the system.</p>
<p>The processes of ID binding and/or verification rely on <strong>nationally/internationally established methods for ID binding and verification, such as national IDs and passports, and regulated customer onboarding processes</strong> (in the case of private companies).</p>
<p>Contrary to many SSI Verifiable Credentials implementations, the PrivacyCredentials system <strong>does not require any registration on the part of the user</strong> like registering her DID in the blockchain or any other repository, as the system relies in pre-existing identification processes (e.g., KYC for private companies).</p>
<p>The personal data elements are incorporated to the certificate and not used for any other thing or purpose. It is assumed that the minimal person identification data specified in this document can be used to perform the ID binding with a national ID, passport or any other suitable nationally issued identity document.</p>
<h2 id="requirements-requirements-data-security-and-privacy-by-design-and-by-default">Data security and privacy by design and by default</h2>
<p>Abuse of data by actors (especially, the certificate verifiers and holders) and forgery should be prevented by any reasonable means. The system should by design and default ensure the security and the privacy of data in the compliant implementations, ensuring both security and privacy.</p>
<p>The system should promote the restriction of access to data and preventing malicious use of data, and at the same time it shoul enable the establishing of the authenticity of data and its link to the certificate holder.
The design should prevent the collection of identifiers or other similar data which might be crossreferenced with other data and re-used for tracking (‘Unlinkability’).</p>
<p>Unlinkability is one of the main reason why the system does not use any type of hash of personal data registered in the blockchain.</p>
<h2 id="requirements-requirements-inclusiveness-especially-medium-neutrality">Inclusiveness (especially medium-neutrality)</h2>
<p>The system should be inclusive especially towards the individual citizen (‘no citizen left behind’).</p>
<p>The design of the system should attempt to maximize its support for diverse contexts (e.g., high resource vs low resource contexts).</p>
<p>To enable this, the system should support a spectrum of certificate presentation media from plain paper certificate to augmented paper certificates (e.g., paper certificate with printed machinereadable parts such as barcodes, QR codes, Machine Readable Zones) and to purely digital certificates (e.g., in-app certificates).</p>
<p>The PrivacyCredentials system supports paper certificates, augmented paper certificates, QR codes and purely digital certificates.</p>
<p>In addition, contrary to many SSI Verifiable Credentials implementations, the PrivacyCred system is implemented as a PWA (Progressive Web App) that can be used simply in a mobile browser (or tablet/PC) without installing anything in the device or registering for anything.</p>
<p>However, the user can install the PWA in the device if the user so wishes to facilitate future uses. In any case, the system does not require any type of registration of the identity of the user.</p>
<h2 id="requirements-requirements-simplicity-and-user-friendliness">Simplicity and user-friendliness</h2>
<p>It is very important that the system is designed with simplicity and user-friendliness of the possible implementation of digital certificate systems in mind.</p>
<p>More formally, the system should not have features or functionalities that would unnecessarily complicate the resulting implementation of a digital certificate system or make them unnecessarily difficult to use. Lack of simplicity could increase the time it takes to implement the compliant digital certificate systems, while lack of user friendliness could hinder the uptake of the resulting implementations. User-friendliness is relevant for quick and easy processing, specifically to certificate holders and to verifiers.</p>
<p>The PrivacyCredentials system follows the rule of <strong>Occam's Razor</strong> eliminating any feature or functionality which is not strictly required for the use case.</p>
<p>This not only provides simplicity and user-friendlyness but also provides a system easier to understand and maintain which is more secure and robust.</p>
<h2 id="requirements-requirements-modularity-and-scalability">Modularity and scalability</h2>
<p>The system architecture should be modular and easily scalable, for instance, to additional usage scenarios, use cases and types of certificates.</p>
<p>The system is massively scalable because generation and verification of credentials are <a href="https://en.wikipedia.org/wiki/Embarrassingly_parallel">embarrasingly parallel</a> tasks and the blockchain is never a bottleneck.</p>
<p>The system already supports different usage scenarios (e.g. alternative settings in which certificates may be requested or verification may take place).</p>
<h2 id="requirements-requirements-open-standards">Open standards</h2>
<p>The system should rely for its implementations on open standards, to the extent that this is possible. This will greatly contribute to the interoperability of the resulting implementations, in addition combined with open governance and open source implementations, it will instil trust in the involved stakeholders.</p>
<h2 id="requirements-requirements-interoperability">Interoperability</h2>
<p>Implementations of certificates that comply with the specifications should be interoperable, both at the infrastructure and at the national level.</p>
<p>This means that if Countries A and B implement the specifications, it should be possible for a verifier in Country B to verify a digital certificate that has been issued in Country A.</p>
<p>Cross-border interoperability should be ensured across EU and EEA countries. The system should be also prepared for interoperability with the solutions designed on a global level.</p></section><h1 class='nav-section-title-end'>Ended: Requirements</h1><h1 class='nav-section-title'>Architecture</h1><section class="print-page" id="architecture-ar-overview"><h1 id="architecture-ar-overview-overview-of-the-system">Overview of the system</h1>
<p>This section provides an overview of the system. The description is focused especially on the privacy characterictics of the system, given that it is the most important property. </p>
<h2 id="architecture-ar-overview-the-three-zones-for-personal-data">The three zones for personal data</h2>
<p>To facilitate reasoning about tecnology and personal data, the system can be divided into three relevant zones.</p>
<figure class="figure-image">
  <img src="../architecture/ar-overview/Slide5.PNG" alt="The three zones for personal data">
  <figcaption>The three zones for personal data</figcaption>
</figure>

<p>At the top we have the <code>citizen's zone</code>, represented in green.
In the intermediate level we have the <code>entities zone</code>, with the businesses and organistions that manage or process personal data from the citizens, and represented in yellow.
At the bottom we have the <code>blockchain zone</code>. It is red because the fundamental rule for any blockchain application is that personal data never has to be written to the blockchain, even if it is encrypted (encrypted personal data is considered personal data if it is exposed publicly for a sufficiently long period).</p>
<p>There are many discussions about what can be considered personal data, and if a hash of personal data is considered personal data or not. But this is irrelevant here because in this system no personal data is ever written to the blockchain, including any type of hash from personal data.</p>
<p>The blockchain is used to register the public information about the identities of the juridical persons involved, including the public key that will be used to verify the signatures from the entities issuing certificates.
The blockchain stores a decentrally managed Trusted List of entities which are authorised to create and digitally sign certificates of a given type. The Trusted List can be organised by domains, geographical regios or any other criteria that may be adecuate to th euse cases. It is modelled similarly as the Internet DNS system.</p>
<h2 id="architecture-ar-overview-the-flow-of-a-certificate">The flow of a certificate</h2>
<p>The following figure describes the basic flow of a certificate:</p>
<figure class="figure-image">
  <img src="../architecture/ar-overview/Slide6.PNG" alt="The flow of  certificate">
  <figcaption>The flow of  certificate</figcaption>
</figure>

<p>The authorised issuer entity creates and digitally signs the certificate, and sends it to the citizen via several mechanisms. The personal data flows are marked in red.</p>
<p>The relationship between the citizen and the issuer entity is subject to current regulation (e.g., GDPR) and the existence of the blockchain does not change anything.
The diagram presents also the possibility that the entity stores some personal data in its own data base, always within the framework of the same personal data regulation.</p>
<p>The critical feature is that there is not any write operation to the blockchain during the issuance process.</p>
<p>The certificate is sent from the citizen to the verifier by means of a QR code which is implemented in such a way that there is no need for any intermediate server. Transmission is purely P2P in the safe <code>citizen's zone</code> without involvement of any entity, of course not even the issuer of the certificate.</p>
<h2 id="architecture-ar-overview-replicating-the-privacy-features-of-the-physical-world">Replicating the privacy features of the physical world</h2>
<p>The privacy features of the system can be better understood by making an analogy with the real world: The citizen is holding a wallet and a set of cards inside.</p>
<figure class="figure-image">
  <img src="../architecture/ar-overview/Slide7.PNG" alt="Comparison with a physical wallet">
  <figcaption>Comparison with a physical wallet</figcaption>
</figure>

<p>This is represented in the figure above and the following properties hold:</p>
<ul>
<li>
<p>The citizen can use whatever wallet she wishes, because the wallet follows a set of standards. In the physical world, all wallets are interchangeable as far as they can hold standard-size cards.</p>
</li>
<li>
<p>The citizen can use more than one wallet, either in parallel or sequentially. In the physical world, she can easily move the cards from one wallet to another, depending on the situation (e.g., she goes to the beach and moves a subset of the cards to a special wallet for a specific period of time).</p>
</li>
<li>
<p>In order to obtain a wallet, the citizen does not need to register in any system or provide any personal data to any entity. In the analogy with the physical world, the citizen can go to a shop and pay for a wallet she likes in complete anonymity with respect to the wallet seller. There may be wallets for free (e.g., as gifts from entities), or if the customer so wishes, <code>fancy</code> wallets that the citizen has to pay.</p>
</li>
<li>
<p>The above does not preclude the existence of wallets that require registration from citizens (and so requiring personal data). In the physical world, this may be analogous to obtaining a wallet because the citizen belongs to a club or is employed in a company, or as a gift because the citizen is the customer of a company.</p>
</li>
<li>
<p>Once the citizen uses the wallet, the wallet does not send any personal information to the provider of the wallet. In the physical world, once the citizen has received the wallet, the seller of the wallet has no idea of what is the actual usage of the wallet by the citizen.</p>
</li>
<li>
<p>However the digital wallet may communicate with the wallet provider to obtain patches or upgrades, especially security fixes. In the physical world this would be analogous to the citizen going to the shop for some repairs on her wallet.</p>
</li>
</ul>
<h2 id="architecture-ar-overview-obtaining-the-public-keys-for-local-verification-in-the-mobile">Obtaining the public keys for local verification in the mobile</h2>
<p>We now complete the flow of information in the system for the basic credential issuance and verification process.</p>
<p>In order to be able to perform local verification of credentials in the mobile, we need the public keys of issuers. This is represented in the following figure, where the arrows are green because the information is public and in addition they are queries, never writes.</p>
<p>There may be two main scenarios: one where the verifier is an individual citizen and the second when the verifier is an employee acting on behalf of a company that wants to verify certificates as part of its business process (e.g., a hotel on check-in of guests). We discuss here the first scenario, and the second will be discussed in the next section.</p>
<figure class="figure-image">
  <img src="../architecture/ar-overview/Slide8.PNG" alt="Public keys and local verification">
  <figcaption>Public keys and local verification</figcaption>
</figure>

<p>In this scenario there are two citizens involved: the one holding the credential and the one acting as verifier.</p>
<p>The mobile of the citizen acting as verifier can not access directly the blockchain and requires an intermediate server, operated by some entity. Typically, that entity operates both a "traditional" server and a blockchain node that it can access without restriction.</p>
<p>From the point of view of data privacy, the intermediate server can never have access to the personal data of the citizen presenting the credential to the verifier.</p>
<p>For the verifier, the amount of harm that an untrusted entity can make is very low, but in any case it is important that verifiers use a trusted server or even better a pool of trusted servers.</p>
<p>The server receives HTTP GET requests from the verifier mobile for retrieving the public keys. Even though this is not done on each verification (the verifier mobile has a cache which is updated periodically), those requests could be used to try to track the citizen acting as verifier, using techniques like for example <a href="https://en.wikipedia.org/wiki/Device_fingerprint">device fingerprinting</a>.</p>
<p>It is expected that several trusted entities like public administrations, civil organisations or highly-regulated businesses operate intermediate servers that offer publicly the single API which is required for trusted verification by citizens. The service is just a query, very simple and can use aggressive caching techniques so it can scale massively.</p>
<p>Having a pool of public trusted operators of this service improves the resiliency of the verifier against malicious attacks. The citizen acting as verifier can configure the application to build the cache of public keys from queries to several servers, detecting wrong keys and avoiding censorship of some keys or just availability problems in the servers.</p>
<h2 id="architecture-ar-overview-optional-verification-in-a-server">Optional: verification in a server</h2>
<p>In the case when the verifier is an employee acting on behalf of an entity and especially for very small businessess, the scheme described above can also be used. It may also be possible that an industry association provides one or more servers providing the service to its member entities, probably together with the "traditional" services that they may already be receiving from the industry association.</p>
<p>The system also supports making the verification in a given server. This feature may be useful for bigger entities and in some scenarios where they want to apply sophisticated business rules to the verification process, or when they require the storage in their databases of the credential data.</p>
<p>This is represented in the following diagram.</p>
<figure class="figure-image">
  <img src="../architecture/ar-overview/Slide9.PNG" alt="Verification in a server">
  <figcaption>Verification in a server</figcaption>
</figure>

<p>When making the validation in the server the verifier mobile has to send the certificate to the server, and this is represented by the new arrow in the diagram. The arrow is red because there is personal data involved. The entity receiving the personal data should comply with all applicable regulations.</p>
<p>From the diagram it is easy to see that the existence of a blockchain network does not have any influence in how personal data should be handled by all actors involved.</p>
<h2 id="architecture-ar-overview-revocation-of-certificates">Revocation of certificates</h2>
<p>Revocation is normally a very rare event compared to the total number of credentials issued. Actually, in practice in the paper world it is very difficult to implement a real-time verification of paper credentials.</p>
<p>In the digital world, revocation is typically implemented with revocation lists, which are checked in real-time by the verifier application. With centralised technology it is very difficult to implement real-time verification of credentials without leaking information to the server where the revocation list is stored.
Typically, the revocation list is managed by the same entity that issued the credential, giving the opportunity to this entity to track usage at the individual level of the credentials that were issued, knowing where and when the credential is used.</p>
<p>Managing the revocation list in the blockchain brings several benefits. When the revocation information is inserted in one of the nodes, it is replicated in all the nodes of the network and it is available for verification in all of them. That means that the verifier can securely check in its own node whithout leaking any verification information to any other entity, especifically the issuer of the certificate. In addition, the verifier entity can completely manage the availability of its own node (or nodes), without reliance on the availability of any server operated by a third party.</p>
<p>However, a lot of care should be taken with the information of the certificate that is used in the revocation list, because that information will be permanent in the blockchain. If the revocation identifier is derived in some way from the personal information in the credential (e.g. hashes calculated using information in the credential), then there may be risks of reidentification in the long term, especially for credentials of a very small size and with a small number of fields.</p>
<p>In the PrivacyCredentials system each credential has a <strong>U</strong>niversally <strong>U</strong>nique <strong>ID</strong>entifier version 4 (UUID) as defined in <a href="https://datatracker.ietf.org/doc/html/rfc4122#section-4.4">RFC 4122</a>. This UUID is completely urelated to the rest of the information in the credential and reduces the possibility of many typs of attacks.</p></section><section class="print-page" id="architecture-relationship-with-eucovid"><h1 id="architecture-relationship-with-eucovid-relationship-with-eu-digital-covid-certificate">Relationship with EU Digital COVID Certificate</h1>
<p>We could say that PrivacyCredentials is a blockchain-based implementation of the EU Digital COVID Certificates (EUDCC) specification.</p>
<p>The meaning of this sentence is multiple.</p>
<p>On one hand, it means that the system is interoperable with the EU Digital COVID Certificates:</p>
<ul>
<li>The PrivacyCredentials wallet can scan and store any EUDCC QR code, and can coexist with credentials in other formats (e.g., W3C VC).</li>
<li>The wallet can display the human-readable information of a stored EUDCC, including its QR code in EUDCC format so it can be verified by any compatible verifier.</li>
<li>The PrivacyCredentials verifier can scan and verify any EUDCC certificate.</li>
</ul>
<p>But usage of EUDCC goes beyond the above:</p>
<ul>
<li>The system can issue and verify credentials using the same technical format as the "official" EUDCC credentials (vaccination, test, and recovery), the only difference being that the certificates would be signed by entities which not necessarily are in the trusted list maintained by the EU Member States.</li>
<li>Those additional certificates can be not only health-related (like in the Lanzarote CovidSafe project), but they can belong to any other use case in any field where the same strong-privacy guarantees are required.</li>
<li>The major difference is that the identities of the entities involved in the use case are managed in the blockchain, making the system easier to implement, more scalable and resilient.</li>
</ul>
<h2 id="architecture-relationship-with-eucovid-relationship-with-eu-digital-covid-certificates">Relationship with EU Digital COVID Certificates</h2>
<p>To better describe the system, the next section compares it with the "standard" EUDCC system. We use the information from the eHealth Network in the document <a href="https://ec.europa.eu/health/sites/health/files/ehealth/docs/trust-framework_interoperability_certificates_en.pdf">Interoperability of health certificates Trust framework</a>, describing its characteristics and the differences.</p>
<p>For the explanation of how PrivacyCred can complement and improve the proposed eHealth Network system, first we need to draw the proposed Trust Framework in a different but completely equivalent way, in the following figure.</p>
<figure class="figure-image">
  <img src="../architecture/relationship-with-eucovid/ehealth_PKD.png" alt="EU PKD system">
  <figcaption>EU PKD system</figcaption>
</figure>

<p>In the standard eHealth Network system, each country uploads to a central service (operated by the EU Commission) the keys/certificates specific to that country, and downloads from that service the keys/certificates from all the other countries that use the system. In this way, the <strong>EU Public Key Directory/Gateway</strong> (EU PKD) helps the different countries to maintain in each country a database with all the keys/certificates for all authorised issuers.</p>
<p>When one verifier entity in a country needs to verify a certificate presented by a traveler, it can do so by checking against the local copy (meaning in the verification country) of all keys/certificates maintained via the replication mechanism described above.</p>
<p>There are several ways in which a blockchain-based system like PrivacyCred could add value without modifying the essential processes or safety of the proposed system.</p>
<h3 id="architecture-relationship-with-eucovid-option-1">Option 1</h3>
<p>Regarding the list of authorised issuers, the eHealth Network system requires that for each country its list should be published on its PHA’s website (national backend server). In addition, the list may also be published through an open API.</p>
<p>In Option 1, in addition to publishing the list in the website it could be published in a blockchain. In that way, the list is hyper-replicated in a secure and tamper-resistant way in all the nodes of the blockchain network.</p>
<p>This facilitates secure verification by any entity (hotels, restaurants, etc) without overloading the website of the PHA. In other words, it implements a <strong>massively scalable and highly available read-only database for checking the keys/certificates of authorised issuers</strong>. The number of writes to the blockchain is very low (only writing when the list of authorised issuers changes), and the reads are performed locally in each of the nodes operated by each entity participating in the blockchain.</p>
<p>In a sense, it would be a mechanism complementary to the open API mechanism but cheaper, more available and more scalable.</p>
<h3 id="architecture-relationship-with-eucovid-option-2">Option 2</h3>
<p>Similar to Option 1, but publishing the full EU list in the blockchain. This could be done by a given country using the database that it has using the EU PKD, or it could even be performed by the EU entity providing the PKD service (most probably the Commission, as it happens with the European Federation Gateway Service).</p>
<p>Please note that in Option 1, there could be several countries that coordinate with each other and publish their lists in the same way in the blockchain, creating a single read-only list for any entity that wants to verify certificates.</p>
<h3 id="architecture-relationship-with-eucovid-other-options">Other options</h3>
<p>In the future, there could be more "ambitious" options. For example, when EBSI (European Blockchain Services Infrastructure) is in production, it could be used as a complement or even replacing completely the EU PKD centralised system. Each country would keep their sovereignty regarding managing their authorised issuers list, but the replication of that data across the EU could be simplified enormously using the EBSI blockchain network.</p>
<p>In the same way, there could be different "national" or even pan-european blockchain networks that could be used by countries to "disseminate" the master lists in a safe, cheap and available way.</p>
<p>The eHealth Network document mentions the <a href="https://www.icao.int/Security/FAL/PKD/Pages/default.aspx">ICAO PKD</a>, and in its own words (emphasis added):</p>
<div class="admonition quote">
<p class="admonition-title">ICAO PKD</p>
<p>The publication of a Master List enables other receiving States to obtain a set of CSCA certificates from a single source (the Master List issuer) rather than establish a direct bilateral exchange with each of the Issuing Authorities or organizations represented on that list. However, <strong>the more instances of a CSCA certificate that a receiving State acquires</strong> — whether through multiple Master Lists, bilateral exchange, or both — <strong>the more confident</strong> the receiving State can be that the CSCA certificate they are using for validation is authentic. In this respect, Master Lists contribute to building and improving trust based on CSCA certificates.</p>
</div>
<p>The blockchain-based PKD could coexist with the centralised PKD (at least while the centralised one is worthwhile), complementing it and providing in a secure way more places where the lists are available for verifiers.
For example, the current ICAO PKD service is hosted in identical systems within two geographically separate sites (location A being located in Berlin, Germany and location B being located in Abu Dhabi, United Arab Emirates). An operator location is additionally provided within the ICAO headquarters (being located in Montreal, Canada). The two hosting sites are designed so that each of them can take over the work of the other site should one of them fail.</p>
<h3 id="architecture-relationship-with-eucovid-summary">Summary</h3>
<p>A blockchain-based system could provide several benefits, including:</p>
<ul>
<li>
<p>Greater resiliency by replicating in a simple and secure way the Master Lists and associated data.</p>
</li>
<li>
<p>Better scalability, as most of the operations in the PKD system are reads (for verifications). Using a blockchain the data is hyper-replicated in a tamper-resistant way in all the nodes of the network, and the verifications can be done to servers which are very close to the geographical location of the verifier.</p>
</li>
<li>
<p>An alternative method to the current download method for users of the PKD data. It is enough to operate a node in the blockchain network and the data is updated automatically when the central PKD repository is updated (assuming the update process includes updating the data in the blockchain). Nobody can tamper with the data and the history of the previous versions of the Master Lists are available if needed.</p>
</li>
</ul></section><h1 class='nav-section-title-end'>Ended: Architecture</h1><h1 class='nav-section-title'>DID Methods</h1><section class="print-page" id="didmethods-elsi"><h1 id="didmethods-elsi-elsi-did-method-for-organisations">ELSI: DID Method for organisations</h1>
<p>The system supports several DID Methods, using the Universal Resolver to resolve each DID into a corresponding DID Document.</p>
<p>However, the main DID method used for organisations and currently implemented in Alastria Red-T is <strong>ELSI</strong>, where the identities of juridical persons are anchored into a Public-Permissioned blockchain.</p>
<p>The name ELSI stands for <strong>E</strong>TSI <strong>L</strong>egal person <strong>S</strong>emantics <strong>I</strong>dentifier, because it is based on the <em>Legal person semantic identifier</em> defined in the <a href="https://www.etsi.org/deliver/etsi_en/319400_319499/31941201/01.04.02_20/en_31941201v010402a.pdf">European Norm ETSI EN 319 412-1</a>, related to digital signatures, peer entity authentication, data authentication as well as data confidentiality.</p>
<p>The basic idea is to generate the DID deterministically from an existing and widely accepted identifier, which is already required by any organisation in the real world in order to perform any relevant activity.</p>
<p>The rational for ELSI is the following:</p>
<dl>
<dt><strong>The DID for a juridical person is essentially different to the DID for a natural person.</strong></dt>
<dd>
<p>Identities of juridical persons are public, together with information associated to the identity. This is not optional, and before an organisation starts performing any relevant operation in the real world, it has to be registered in some official register, where the identity and associated information is publicly acessible.</p>
<p>However, real-world identities of natural persons and associated PII are subject to very strict privacy regulations (GDPR). Identities are not public, and special care should be taken to keep everything related to the identity private.</p>
<p>This suggests the need for totally different mechanisms to generate and manage the DIDs of those radically different types of entities. Clean separation of the mechanisms allows for easier implementation of each set of requirements, without polluting the code with logic to handle both cases, which is prone to error.
Of course, there is nothing preventing reuse of common logic across both implementations, but only when it makes sense and maintaining the clean separation principle.</p>
<p>In addition, this separation reflects current practice in managing identities of organisations and natural persons, so it is easier to leverage existing know-how.</p>
</dd>
<dt><strong>Most organisations can already be identified by the VAT or LEI (or both).</strong></dt>
<dd>
<p>For example, businesses have to be registered in the Business Registrar of the country of incorporation, including the compulsory Tax Identification Number or VAT. Even organisations which do not require a VAT to be incorporated are required to have a LEI (Legal Entity Identifier).</p>
<p>Using the VAT and LEI can identify an enormous amount of organisations: businesses, non profits, universities, research centers, public administrations, etc.</p>
<p>In exceptional cases where VAT or LEI can not be used, ELSI uses the extensibility mechanism in <code>ETSI EN 319 412-1</code> to include any existing type of compulsory registration, whether international or just national.</p>
</dd>
</dl>
<p>These requirements have nothing to do with whether we use centralised technology or blockchains. It is an essential characterictic in any developed economy like the EU.</p>
<p>This means that the creation of the DID is completely decentralised from the point of view of the blockchain networks, because the entities willing to participate already possess everything which is needed in order to create the DID. We do not need to put in place any other entity or system to create the DID.</p>
<p>The ETSI norm on which ELSI is based specifies several possible identifiers that can be used to build the DID. The two most common and the ones used in ELSI are the <code>VAT</code> (Tax Identifier) and the <code>LEI</code> (<a href="https://www.gleif.org">Legal Entity Identifier</a>).</p>
<p>Using both <code>VAT</code> and <code>LEI</code> in creating the DID covers every juridical person that can participate in a blockchain network, not only in the EU but in most of the world. In any case, the system is extensible and it is fairly easy to incorporate new legal identifiers if the need arises in the future.</p>
<h2 id="didmethods-elsi-elsi-did-syntax">ELSI DID syntax</h2>
<p>The ELSI DID Method refers only to legal persons, so we are using the <code>id-etsi-qcs-SemanticsId-Legal</code> definition described in Section 5.1 of ETSI EN 319 412-1.</p>
<p>Creating a DID is extremely simple and fully decentralized (does not require participation of any central authority), assuming that the legal person already exists. Its definition using ABNF syntax is:</p>
<div class="highlight"><pre><span></span><code>    <span class="n">did</span> <span class="o">=</span> <span class="s2">&quot;did:elsi:&quot;</span> <span class="nb">id</span><span class="o">-</span><span class="n">etsi</span><span class="o">-</span><span class="n">qcs</span><span class="o">-</span><span class="n">SemanticsId</span><span class="o">-</span><span class="n">Legal</span>
</code></pre></div>
<p>Which is the concatenation of the prefix <code>did:elsi:</code> with the legal person identifier defined in ETSI EN 319 412-1. For the full syntax, please refer to the standards document, but for the two most common basic identifiers (VAT and LEI) the identifier is composed of:</p>
<ul>
<li>3 character legal person identity type reference, like <code>VAT</code> for identification based on a national value added tax identification number or <code>LEI</code> for the <a href="https://www.gleif.org">Legal Entity Identifier</a>.</li>
<li>2 character ISO 3166 [2] country code;</li>
<li>hyphen-minus "-" (0x2D (ASCII), U+002D (UTF-8)); and</li>
<li>identifier (according to country and identity type reference).</li>
</ul>
<p>Some examples of DIDs are the following:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>DID</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>AgID</strong> (www.agid.gov.it)</td>
<td><strong>did:elsi:VATIT-97735020584</strong></td>
</tr>
<tr>
<td><strong>Hashnet d.o.o.</strong> (hashnet.tech)</td>
<td><strong>did:elsi:VATSI-18035094</strong></td>
</tr>
<tr>
<td><strong>Alastria</strong> (alastria.io)</td>
<td><strong>did:elsi:VATES-G87936159</strong></td>
</tr>
<tr>
<td><strong>Enel Spa</strong> (www.enel.com)</td>
<td><strong>did:elsi:VATIT-15844561009</strong></td>
</tr>
<tr>
<td><strong>Endesa S.A.</strong> (www.endesa.com)</td>
<td><strong>did:elsi:VATES-A81948077</strong></td>
</tr>
<tr>
<td><strong>Inter-American Development Bank</strong> (www.iadb.org)</td>
<td><strong>did:elsi:LEIXG-VKU1UKDS9E7LYLMACP54</strong></td>
</tr>
</tbody>
</table>
<h2 id="didmethods-elsi-elsi-did-document">ELSI DID Document</h2>
<p>An example DID Document is the following:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;@context&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;https://www.w3.org/ns/did/v1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;https://w3id.org/security/v1&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900&quot;</span><span class="p">,</span>
    <span class="nt">&quot;verificationMethod&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900#key-verification&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;JwsVerificationKey2020&quot;</span><span class="p">,</span>
        <span class="nt">&quot;controller&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900&quot;</span><span class="p">,</span>
        <span class="nt">&quot;publicKeyJwk&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;key-verification&quot;</span><span class="p">,</span>
          <span class="nt">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
          <span class="nt">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;secp256k1&quot;</span><span class="p">,</span>
          <span class="nt">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;3K4iNuzPkcrHlEbhHE8vYXlF6K5xGZ2rdOrn3cQ-LnQ&quot;</span><span class="p">,</span>
          <span class="nt">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;9Z_l_hQLkq6aLuZz8gheq7R_o5ZUHUlxZ3IBGHsdzaA&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;service&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900#info&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;EntityCommercialInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;serviceEndpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;www.in2.es&quot;</span><span class="p">,</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;IN2 Innovating 2gether&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900#sms&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;SecureMessagingService&quot;</span><span class="p">,</span>
        <span class="nt">&quot;serviceEndpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;https://privatecred.hesusruiz.org/api&quot;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;anchors&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;redt.alastria&quot;</span><span class="p">,</span>
        <span class="nt">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;UniversalResolver&quot;</span><span class="p">,</span>
        <span class="nt">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;in2.ala&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ethereumAddress&quot;</span><span class="p">:</span> <span class="s2">&quot;0x8CDA8113567e633805e48c87747257E9FFAAdDF5&quot;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-02-08T06:53:08Z&quot;</span><span class="p">,</span>
    <span class="nt">&quot;updated&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-02-08T06:53:08Z&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></section><h1 class='nav-section-title-end'>Ended: DID Methods</h1><h1 class='nav-section-title'>Credentials</h1><section class="print-page" id="credentials-eu-covid"><h1 id="credentials-eu-covid-eu-digital-covid-credentials">EU Digital COVID Credentials</h1>
<p>The system supports the <strong>EU Digital COVID Credentials</strong> both for storing and verifying them with the wallet and verifier applications.
The system supports generating credentials using exactly the same format as the <code>EU Digital COVID Credential</code>, but in our case the public keys are stored in the blockchain, together with the identities of all entities authorised to issue credentials.</p>
<p>The format and interoperability guidelines are defined in the related documentation from the EU. A brief summary (which should not be considered authoritative) follows.</p>
<h2 id="credentials-eu-covid-common-structure-of-eudcc">Common structure of EUDCC</h2>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;ver&quot;</span><span class="p">:</span> <span class="err">&lt;versio</span><span class="kc">n</span> <span class="err">i</span><span class="kc">nf</span><span class="err">orma</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">&gt;</span><span class="p">,</span>
    <span class="nt">&quot;nam&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="err">&lt;perso</span><span class="kc">n</span> <span class="kc">na</span><span class="err">me</span> <span class="err">i</span><span class="kc">nf</span><span class="err">orma</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">&gt;</span>
    <span class="p">},</span>
    <span class="nt">&quot;dob&quot;</span><span class="p">:</span> <span class="err">&lt;da</span><span class="kc">te</span> <span class="err">o</span><span class="kc">f</span> <span class="err">bir</span><span class="kc">t</span><span class="err">h&gt;</span><span class="p">,</span>
    <span class="s2">&quot;v&quot;</span> <span class="err">or</span> <span class="s2">&quot;t&quot;</span> <span class="err">or</span> <span class="nt">&quot;r&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="err">&lt;vacci</span><span class="kc">nat</span><span class="err">io</span><span class="kc">n</span> <span class="err">dose</span> <span class="err">or</span> <span class="kc">test</span> <span class="err">or</span> <span class="err">recovery</span> <span class="err">i</span><span class="kc">nf</span><span class="err">orma</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="p">,</span> <span class="err">o</span><span class="kc">ne</span> <span class="err">e</span><span class="kc">ntr</span><span class="err">y&gt;</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="credentials-eu-covid-version">Version</h3>
<p>Version information MUST be provided. Versioning is following Semantic Versioning (semver: 
https://semver.org). In production, it MUST be one of the officially released (current or one of the older 
officially released) versions. See Section JSON Schema location for more details.</p>
<table>
<thead>
<tr>
<th>Field id</th>
<th>Field name</th>
<th>Instructions</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ver</strong></td>
<td>Schema version</td>
<td>MUST match the identifier of the schema version used for producing the EUDCC. Example: "ver": "1.3.0</td>
</tr>
</tbody>
</table>
<h3 id="credentials-eu-covid-person-name-and-date-of-birth">Person name and date of birth</h3>
<p>Person name is the official full name of the person, matching the name stated on travel documents. The 
identifier of the structure is nam. Exactly 1 (one) person name MUST be provided.</p>
<table>
<thead>
<tr>
<th>Field id</th>
<th>Field name</th>
<th>Instructions</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>nam.fn</strong></td>
<td>Surname(s)</td>
<td>Surname(s), such as family name(s), of the holder.<br>Exactly 1 (one) non-empty field MUST be provided, with all surnames included in it. In case of multiple surnames, these MUST be separated by a space. Combination names including hyphens or similar characters must however <br>stay the same.<br>Examples:<br>"fn": "Musterfrau-Gößinger"<br>"fn": "Musterfrau-Gößinger Müller"</td>
</tr>
<tr>
<td><strong>nam.fnt</strong></td>
<td>Standardised surname(s)</td>
<td>Surname(s) of the holder transliterated using the same convention as the one used in the holder’s machine readable travel documents (such as the rules defined in ICAO Doc 9303 Part 3).<br>Exactly 1 (one) non-empty field MUST be provided, only including characters A-Z and "&lt;". Maximum length: 80 characters (as per ICAO 9303 specification).<br>Examples:<br>"fnt": "MUSTERFRAU&lt;GOESSINGER"<br>"fnt": "MUSTERFRAU&lt;GOESSINGER&lt;MUELLER"</td>
</tr>
<tr>
<td><strong>nam.gn</strong></td>
<td>Forename(s)</td>
<td>Forename(s), such as given name(s), of the holder.<br>If the holder has no forenames, the field MUST be skipped.<br>In all other cases, exactly 1 (one) non-empty field MUST be provided, with all forenames included in it. In case of multiple forenames, these MUST be separated by a space.<br>Example:<br>"gn": "Isolde Erika"</td>
</tr>
<tr>
<td><strong>nam.gnt</strong></td>
<td>Standardised forename(s)</td>
<td>Forename(s) of the holder transliterated using the same convention as the one used in the holder’s machine readable travel documents (such as the rules defined in ICAO Doc 9303 Part 3).<br>If the holder has no forenames, the field MUST be skipped.<br>In all other cases, exactly 1 (one) non-empty field MUST be provided, only including characters A-Z and "&lt;".<br>Maximum length: 80 characters.<br>Example:<br>"gnt": "ISOLDE&lt;ERIKA"</td>
</tr>
<tr>
<td><strong>dob</strong></td>
<td>Date of birth</td>
<td>Date of birth of the DCC holder.<br>Complete or partial date without time restricted to the range from 1900-01-01 to 2099-12-31. <br>Exactly 1 (one) non-empty field MUST be provided if the complete or partial date of birth is known. If the date of birth is not known even partially, the field MUST be set to an empty string "". This should match the information as provided on travel documents.<br>One of the following ISO 8601 formats MUST be used if information on date of birth is available. Other options are not supported. <br>YYYY-MM-DD<br>YYYY-MM<br>YYYY<br>(The verifier app may show missing parts of the date of birth using the XX convention as the one used in machinereadable travel documents, e.g. 1990-XX-XX.)<br>Examples:<br>"dob": "1979-04-14"<br>"dob": "1901-08"<br>"dob": "1939"<br>"dob": ""</td>
</tr>
</tbody>
</table>
<h3 id="credentials-eu-covid-groups-for-certificate-type-specific-information">Groups for certificate type specific information</h3>
<p>The JSON Schema supports three groups of entries encompassing certificate type specific information. 
Each EUDCC MUST contain exactly 1 (one) group. Empty groups are not allowed.</p>
<table>
<thead>
<tr>
<th>Group identifier</th>
<th>Group name</th>
<th>Entries</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>v</strong></td>
<td>Vaccination group</td>
<td>If present, MUST contain exactly 1 (one) entry describing exactly 1 (one) vaccination dose.</td>
</tr>
<tr>
<td><strong>t</strong></td>
<td>Test group</td>
<td>If present, MUST contain exactly 1 (one) entry describing exactly 1 (one) test result.</td>
</tr>
<tr>
<td><strong>r</strong></td>
<td>Recovery group</td>
<td>If present, MUST contain exactly 1 (one) entry describing 1 (one) recovery statement.</td>
</tr>
</tbody>
</table>
<h2 id="credentials-eu-covid-certificate-type-specific-information">Certificate type specific information</h2>
<h3 id="credentials-eu-covid-vaccination-certificate">Vaccination certificate</h3>
<p>Vaccination group, if present, MUST contain exactly 1 (one) entry describing exactly one vaccination 
event. All elements of the vaccination group are mandatory, empty values are not supported.</p>
<table>
<thead>
<tr>
<th>Field id</th>
<th>Field name</th>
<th>Instructions</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>v.tg</strong></td>
<td>Disease or agent targeted: COVID-19 (SARS-CoV or one of its variants)</td>
<td>A coded value from the value set <code>disease-agent-targeted.json</code>.<br>This value set has a single entry 840539006, which is the code for COVID-19 from SNOMED CT (GPS).<br>Exactly 1 (one) non-empty field MUST be provided.<br>Example:<br>"tg": "840539006"</td>
</tr>
<tr>
<td><strong>v.vp</strong></td>
<td>COVID-19 vaccine or prophylaxis</td>
<td>Type of the vaccine or prophylaxis used.<br>A coded value from the value set <code>vaccine-prophylaxis.json</code>.<br>The value set will be distributed from the EUDCC Gateway starting with the gateway version 1.1.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Example:<br>"vp": "1119349007" (a SARS-CoV-2 mRNA vaccine)</td>
</tr>
<tr>
<td><strong>v.mp</strong></td>
<td>COVID-19 vaccine product</td>
<td>Medicinal product used for this specific dose of vaccination. A coded value from the value set <code>vaccine-medicinal-product.json</code>.<br>The value set will be distributed from the EUDCC Gateway starting with the gateway version 1.1.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Example:<br>"mp": "EU/1/20/1528" (Comirnaty)</td>
</tr>
<tr>
<td><strong>v.ma</strong></td>
<td>COVID-19 vaccine marketing authorisation holder or manufacturer</td>
<td>Marketing authorisation holder or manufacturer, if no marketing authorization holder is present.<br>A coded value from the value set <code>vaccine-mah-manf.json</code>.<br>The value set will be distributed from the EUDCC Gateway starting with the gateway version 1.1.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Example:<br>"ma": "ORG-100030215" (Biontech Manufacturing GmbH)</td>
</tr>
<tr>
<td><strong>v.dn</strong></td>
<td>Number in a series of doses</td>
<td>Sequence number (positive integer) of the dose given during this vaccination event. 1 for the first dose, 2 for the second dose etc.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Examples:<br>"dn": "1" (first dose in a series)<br>"dn": "2" (second dose in a series)<br>"dn": "3" (third dose in a series, such as in case of a booster)</td>
</tr>
<tr>
<td><strong>v.sd</strong></td>
<td>The overall number of doses in the series</td>
<td>Total number of doses (positive integer) in a complete vaccination series according to the used vaccination protocol. The protocol is not in all cases directly defined by the vaccine product, as in some countries only one dose of normally two-dose vaccines is delivered to people recovered from COVID19. In these cases, the value of the field should be set to 1.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Examples:<br>"sd": "1" (for all 1-dose vaccination schedules)<br>"sd": "2" (for 2-dose vaccination schedules)<br>"sd": "3" (in case of a booster)</td>
</tr>
<tr>
<td><strong>v.dt</strong></td>
<td>Date of vaccination</td>
<td>The date when the described dose was received, in the format YYYY-MM-DD (full date without time). Other formats are not supported.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Example:<br>"dt": "2021-03-28"</td>
</tr>
<tr>
<td><strong>v.co</strong></td>
<td>Member State or third country in which the vaccine was administered</td>
<td>Country expressed as a 2-letter ISO3166 code (RECOMMENDED) or a reference to an international organisation responsible for the vaccination event (such as UNHCR or WHO). A coded value from the value set <code>country-2-codes.json</code>.<br>The value set will be distributed from the EUDCC Gateway starting with the gateway version 1.1.<br>Exactly 1 (one) field MUST be provided.<br>Example:<br>"co": "CZ"<br>"co": "UNHCR"</td>
</tr>
<tr>
<td><strong>v.is</strong></td>
<td>Certificate issuer</td>
<td>Name of the organisation that issued the certificate. Identifiers are allowed as part of the name, but not recommended to be used individually without the name as a text. Max 80 UTF-8 characters.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Example:<br>"is": "Ministry of Health of the Czech Republic"<br>"is": "Vaccination Centre South District 3"</td>
</tr>
<tr>
<td><strong>v.ci</strong></td>
<td>Unique certificate identifier</td>
<td>Unique certificate identifier (UVCI) as specified in the vaccinationproof_interoperability-guidelines_en.pdf (europa.eu)<br>The inclusion of the checksum is optional. The prefix "URN:UVCI:" may be added.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Examples:<br>"ci": "URN:UVCI:01:NL:187/37512422923"<br>"ci": "URN:UVCI:01:AT:10807843F94AEE0EE5093FBC254BD813#B"</td>
</tr>
</tbody>
</table>
<h3 id="credentials-eu-covid-test-certificate">Test certificate</h3>
<p>Test group, if present, MUST contain exactly 1 (one) entry describing exactly one test result.</p>
<table>
<thead>
<tr>
<th>Field id</th>
<th>Field name</th>
<th>Instructions</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>t.tg</strong></td>
<td>Disease or agent targeted: COVID-19 (SARS-CoV or one of its variants)</td>
<td>A coded value from the value set <code>disease-agent-targeted.json</code>.<br>This value set has a single entry 840539006, which is the code for COVID-19 from SNOMED CT (GPS).<br>Exactly 1 (one) non-empty field MUST be provided.<br>Example:<br>"tg": "840539006"</td>
</tr>
<tr>
<td><strong>t.tt</strong></td>
<td>The type of test</td>
<td>The type of the test used, based on the material targeted by the test. A coded value from the value set <code>test-type.json</code> (based on LOINC). Values outside of the value set are not allowed.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Example:<br>"tt": "LP6464-4" (Nucleic acid amplification with probe detection)<br>"tt": "LP217198-3" (Rapid immunoassay)</td>
</tr>
<tr>
<td><strong>t.nm</strong></td>
<td>Test name (nucleic acid amplification tests only)</td>
<td>The name of the nucleic acid amplification test (NAAT) used. The name should include the name of the test manufacturer and the commercial name of the test, separated by a comma.<br>For NAAT: the field is optional.<br>For RAT: the field SHOULD NOT be used, as the name of the test is supplied indirectly through the test device identifier (t/ma).<br>When supplied, the field MUST NOT be empty.<br>Example:<br>"nm": "ELITechGroup, SARS-CoV-2 ELITe MGB® Kit"</td>
</tr>
<tr>
<td><strong>t.ma</strong></td>
<td>Test device identifier (rapid antigen tests only)</td>
<td>Rapid antigen test (RAT) device identifier from the JRC database. Value set (HSC common list):<br><ul><li><a href="https://covid-19-diagnostics.jrc.ec.europa.eu/devices?manufacturer&amp;text_name&amp;marking&amp;rapid_diag&amp;format&amp;target_type&amp;field-1=HSC%20common%20list%20%28RAT%29&amp;value-1=1&amp;search_method=AND#form_content">All Rapid antigen tests in HSC common list</a> (human readable).</li><li><a href="https://covid-19-diagnostics.jrc.ec.europa.eu/devices/hsc-common-recognition-rat">https://covid-19-diagnostics.jrc.ec.europa.eu/devices/hsc-common-recognition-rat</a> (machine-readable, values of the field id_device included on the list form the value set).</li></ul>In EU/EEA countries, issuers MUST only issue certificates for tests belonging to the currently valid value set. The value set MUST be updated every 24 hours.<br>Values outside of the value set MAY be used in certificates issued by third countries, however the identifiers MUST still be from the JRC database. The use of other identifiers such as those provided directly by test manufacturers is not permitted.<br>Verifiers MUST detect values not belonging to the up to date value set and render certificates bearing these as invalid. If an identifier is removed from the value set, certificates including it MAY be accepted for a maximum of 72 hours after the removal.<br>The value set will be distributed from the EUDCC Gateway starting with the gateway version 1.1.<br>For RAT: exactly 1 (one) non-empty field MUST be provided.<br>For NAAT: the field MUST NOT be used, even if the NAA test identifier is available in the JRC database.<br>Example:<br>"ma": "344" (SD BIOSENSOR Inc, STANDARD F COVID-19 Ag FIA)</td>
</tr>
<tr>
<td><strong>t.sc</strong></td>
<td>Date and time of the test sample collection</td>
<td>The date and time when the test sample was collected. The time MUST include information on the time zone. The value MUST NOT denote the time when the test result was produced.<br>Exactly 1 (one) non-empty field MUST be provided.<br>One of the following ISO 8601 formats MUST be used. Other options are not supported.<br>YYYY-MM-DDThh:mm:ssZ<br>YYYY-MM-DDThh:mm:ss[+-]hh<br>YYYY-MM-DDThh:mm:ss[+-]hhmm<br>YYYY-MM-DDThh:mm:ss[+-]hh:mm<br>Examples:<br>"sc": "2021-08-20T10:03:12Z" (UTC time)<br>"sc": "2021-08-20T12:03:12+02" (CEST time)<br>"sc": "2021-08-20T12:03:12+0200" (CEST time)<br>"sc": "2021-08-20T12:03:12+02:00" (CEST time)</td>
</tr>
<tr>
<td><strong>t.tr</strong></td>
<td>Result of the test</td>
<td>The result of the test. A coded value from the value set <code>test-result.json</code> (based on SNOMED CT, GPS).<br>Exactly 1 (one) non-empty field MUST be provided.<br>Example:<br>"tr": "260415000" (Not detected)</td>
</tr>
<tr>
<td><strong>t.tc</strong></td>
<td>Testing centre or facility</td>
<td>Name of the actor that conducted the test. Identifiers are allowed as part of the name, but not recommended to be used individually without the name as a text. Max 80 UTF-8 characters. Any extra characters should be truncated. The name is not designed for automated verification.<br>For NAAT tests: exactly 1 (one) non-empty field MUST be provided.<br>For RAT tests: the field is optional. If provided, MUST NOT be empty.<br>Example:<br>"tc": "Test centre west region 245"</td>
</tr>
<tr>
<td><strong>t.co</strong></td>
<td>Member State or third country in which the test was carried out</td>
<td>Country expressed as a 2-letter ISO3166 code (RECOMMENDED) or a reference to an international organisation responsible for carrying out the test (such as UNHCR or WHO). This MUST be a coded value from the value set <code>country-2-codes.json</code>.<br>The value set will be distributed from the EUDCC Gateway starting with the gateway version 1.1.<br>Exactly 1 (one) field MUST be provided.<br>Examples:<br>"co": "CZ"<br>"co": "UNHCR"</td>
</tr>
<tr>
<td><strong>t.is</strong></td>
<td>Certificate issuer</td>
<td>Name of the organisation that issued the certificate. Identifiers are allowed as part of the name, but not recommended to be used individually without the name as a text. Max 80 UTF-8 characters.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Examples:<br>"is": "Ministry of Health of the Czech Republic"<br>"is": "North-West region health authority"</td>
</tr>
<tr>
<td><strong>t.ci</strong></td>
<td>Unique certificate identifier</td>
<td>Unique certificate identifier (UVCI) as specified in the vaccination_proof_interoperability-guidelines_en.pdf (europa.eu)<br>The inclusion of the checksum is optional. The prefix "URN:UVCI:" may be added.<br>Exactly 1 (one) non-empty field MUST be provided.<br>Examples:<br>"ci": "URN:UVCI:01:NL:187/37512422923"<br>"ci": "URN:UVCI:01:AT:10807843F94AEE0EE5093FBC254BD813#B"</td>
</tr>
</tbody>
</table>
<h3 id="credentials-eu-covid-recovery-certificate">Recovery certificate</h3>
<p>Recovery group, if present, MUST contain exactly 1 (one) entry describing exactly one recovery 
statement. All elements of the recovery group are mandatory, empty values are not supported.</p>
<p>Its specification is not detailed here, but you can get it from the official eHealth site.</p></section><section class="print-page" id="credentials-w3c"><h1 id="credentials-w3c-w3c-verifiable-credentials">W3C Verifiable Credentials</h1>
<h2 id="credentials-w3c-data-model">Data Model</h2>
<p>The credential uses the standard <a href="https://www.w3.org/TR/vc-data-model">W3C Verifiable Credentials Data Model</a> for its representation, with some extensions to facilitate interoperability across blockchains.</p>
<p>The specific credential data is encoded in the <code>credentialSubject</code> field of the VC. The following figure represents the VC structure without the specific credential data.</p>
<p><img alt="Kroki" src="https://kroki.io/plantuml/svg/eNqdlF1rgzAUhu_9FcHdtn7VivOq0g1WGGzg6M0oI9XTmjaLYqKujP73mU5tXe3oJgTJed9zfE5ycMIFzsSGJwwFeAUzTjGL3ubTAL-nFJSbmKxjWi2BVMK52gkU4dke6UgNM4iACYJpkC83EIorXTJafSOHyP9Xitw8Ei5QskIMRJlk2wpY-VTQ4Tnwe0iNSOQB5cSb-y_3wdB3Hcu0bMtQB42R50tptB3TcMaG-3BUCBaVYjqGOzassWO3AnyktXA7sk-FCt1DDUIdm4QJE_AhS712lFqPhUi5p-tlWWrlSEuytW4Zpqsf--d6YbZUvbmYYi4ygrU1EXG-1Eiik0Oy2P2pTpqRAoc7mXIA0UqgdLhlSclONVmnU2bRraqKXQqX-p1DRlYELylMW7J-Kr_u6vqM52_GE9uvmOcj9vP2zox3WOALroaa7dDRL0dL7THve_nb6e4_u9p1NvaDy97aM4u0Zkb6aBa9NBQKoE8rv4LKMAvljVod315p3ntlAiySPxblC5PnH3s=" /></p>
<p>The figure above represents the VC where some fields have been marked:</p>
<ol>
<li>
<p>The <code>iss</code> field (issuer in VC terminology), uses the DID method <code>elsi</code>, specific for juridical persons and explained in a section below.</p>
</li>
<li>
<p>There is an extension to specify the blockchain network (or networks) where the VC can be verified. More precisely, the <code>issuedAt</code> field of <code>credentialSubject</code> specifies the networks where the identity for the juridical person that issued the credential can be verified.</p>
</li>
</ol>
<p>A juridical person can have its <code>elsi</code> DID registered in one or more networks, and the same credential can be verified using any of those networks. The trust on the credential depends on the trust on the registration procedure of the identity of the signer. The Verifier entity can choose to verify the credential in whatever network is trusted to the Verifier.</p>
<p>This mechanism provides a lot of flexibility in interoperability schemes across networks. More details are described in the section on interoperability.</p>
<h2 id="credentials-w3c-example-of-verifiable-credential">Example of Verifiable Credential</h2>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;exp&quot;</span><span class="p">:</span> <span class="mi">1614770844</span><span class="p">,</span>
  <span class="nt">&quot;iat&quot;</span><span class="p">:</span> <span class="mi">1614252444</span><span class="p">,</span>
  <span class="nt">&quot;iss&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-X12345678X&quot;</span><span class="p">,</span>
  <span class="nt">&quot;sub&quot;</span><span class="p">:</span> <span class="s2">&quot;46106508H&quot;</span><span class="p">,</span>
  <span class="nt">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;829588b3162249d28f3eae5e84349777&quot;</span><span class="p">,</span>
  <span class="nt">&quot;vc&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;@context&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;https://www.w3.org/2018/credentials/v1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;https://alastria.github.io/identity/credentials/v1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;https://privacycred.org/.well-known/privacycred/v1&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;VerifiableCredential&quot;</span><span class="p">,</span>
      <span class="s2">&quot;AlastriaVerifiableCredential&quot;</span><span class="p">,</span>
      <span class="s2">&quot;PrivacyCredential&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;credentialSchema&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PrivacyCredential&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;JsonSchemaValidator2018&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;credentialSubject&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;privacyCredential&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;citizen&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;dob&quot;</span><span class="p">:</span> <span class="s2">&quot;27-04-1982&quot;</span><span class="p">,</span>
          <span class="nt">&quot;idnumber&quot;</span><span class="p">:</span> <span class="s2">&quot;46106508H&quot;</span><span class="p">,</span>
          <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;COSTA/ALBERTO&quot;</span><span class="p">,</span>
          <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;atRisk&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;comments&quot;</span><span class="p">:</span> <span class="s2">&quot;These are some comments&quot;</span>
      <span class="p">},</span>
      <span class="nt">&quot;issuedAt&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;redt.alastria&quot;</span><span class="p">],</span>
      <span class="nt">&quot;levelOfAssurance&quot;</span><span class="p">:</span> <span class="mi">2</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="credentials-w3c-verification-of-the-credentials">Verification of the credentials</h2>
<p>In general, verifying a credential received as a JWT involves the following:</p>
<ol>
<li>Deserialize the JWT without verifying it (we do not yet have the public key).</li>
<li>Get the <code>kid</code> property from the header (the JOSE header of the JWT).</li>
<li>The <code>kid</code> has the format did#id where <code>did</code> is the DID of the issuer and <code>id</code> is the identifier of the key in the DIDDocument associated to the DID.</li>
<li>Perform resolution of the DID of the issuer with the Universal Resolver API.</li>
<li>Get the public key specified inside the DIDDocument.</li>
<li>Verify the JWT using the public key associated to the DID.</li>
<li>Verify that the DID in the <code>iss</code> field of the JWT payload is the same as the one that signed the JWT.</li>
</ol>
<p>The system includes two APIs to help client applications with the verification of credentials received from other actors in the ecosystem. The choice of API depends on the trust level of the client application on the server implementing the APIs.</p>
<h3 id="credentials-w3c-using-the-universal-resolver-api">Using the Universal Resolver API</h3>
<p>In the first option the client obtains the public key of the Issuer via DID resolution. Then the client performs the cryptographic verification using the public key, without reliance on any other party.</p>
<p>The API for DID resolution is described below:</p>
<div class="admonition apidoc">
<p class="admonition-title">Universal DID resolution</p>
<p><div class="apidoc-getbox">
    <span class="apidoc-get">GET</span>
    <span class="apidoc-url">/api/did/v1/identifiers/{string:DID}</span>
</div></p>
<p>Resolves a DID and returns the DID Document (JSON format), if it exists.
It supports four DID methods: <strong>ebsi</strong>, <strong>elsi</strong>, <strong>ala</strong>, <strong>peer</strong>.</p>
<p>Only <strong>PEER</strong> and <strong>ELSI</strong> are directly implemented by this API.
The others are delegated to be resolved by their respective implementations.</p>
<p>For example, for <strong>EBSI</strong> we call the corresponding Universal Resolver API, currently in testing and available at <a href="https://api.ebsi.xyz/did/v1/identifiers/">https://api.ebsi.xyz/did/v1/identifiers/</a></p>
<p><strong>Request parameters</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DID</strong></td>
<td>string</td>
<td>The DID to resolve into a DID Document</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Reply</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>payload</strong></td>
<td>json</td>
<td>The DID document associated to the input DID</td>
</tr>
</tbody>
</table>
<p><strong>Status codes</strong></p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>200</strong></td>
<td>no error</td>
</tr>
<tr>
<td><strong>404</strong></td>
<td>error resolving the DID</td>
</tr>
</tbody>
</table>
<p><strong>Example request</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/api/did/v1/identifiers/did:elsi:VATES-B60645900</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">example.com</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/json</span>
</code></pre></div>
<p><strong>Example response</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@context&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;https://www.w3.org/ns/did/v1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;https://w3id.org/security/v1&quot;</span>
        <span class="p">],</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900&quot;</span><span class="p">,</span>
        <span class="nt">&quot;verificationMethod&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900#key-verification&quot;</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;JwsVerificationKey2020&quot;</span><span class="p">,</span>
                <span class="nt">&quot;controller&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900&quot;</span><span class="p">,</span>
                <span class="nt">&quot;publicKeyJwk&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;key-verification&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;secp256k1&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;3K4iNuzPkcrHlEbhHE8vYXlF6K5xGZ2rdOrn3cQ-LnQ&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;9Z_l_hQLkq6aLuZz8gheq7R_o5ZUHUlxZ3IBGHsdzaA&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;service&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900#info&quot;</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;EntityCommercialInfo&quot;</span><span class="p">,</span>
                <span class="nt">&quot;serviceEndpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;www.in2.es&quot;</span><span class="p">,</span>
                <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;IN2 Innovating 2gether&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900#sms&quot;</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;SecureMessagingService&quot;</span><span class="p">,</span>
                <span class="nt">&quot;serviceEndpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;https://privatecred.hesusruiz.org/api&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;anchors&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;redt.alastria&quot;</span><span class="p">,</span>
                <span class="nt">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;UniversalResolver&quot;</span><span class="p">,</span>
                <span class="nt">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;in2.ala&quot;</span><span class="p">,</span>
                <span class="nt">&quot;ethereumAddress&quot;</span><span class="p">:</span> <span class="s2">&quot;0x8CDA8113567e633805e48c87747257E9FFAAdDF5&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-02-08T06:53:08Z&quot;</span><span class="p">,</span>
        <span class="nt">&quot;updated&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-02-08T06:53:08Z&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h3 id="credentials-w3c-delegating-verification-to-a-trusted-server">Delegating verification to a trusted server</h3>
<p>In the second option the client delegates to a trusted server the verification of the credential, simplifying the code and complexity of secure cryptographic operatios to the server. This option maybe used when the client trusts the server as it happens when they are operated by the same entity. It can be also used when the server is operated by a public administration and the citizen trusts on it.</p>
<p>This is the easiest one to use, but requires a very high level of trust. The API is described below:</p>
<div class="admonition apidoc">
<p class="admonition-title">Verification of credential in the server</p>
<p><div class="apidoc-postbox">
    <span class="apidoc-post">POST</span>
    <span class="apidoc-url">/api/verifiable-credential/v1/verifiable-credential-validations</span>
</div></p>
<p>Receives a JWT in the JWS Compact Serialization format (<a href="https://datatracker.ietf.org/doc/html/rfc7519">RFC 7519</a>) as the body of the POST request and the server verifies the credential and credential signature using internally the Universal Resolver API for resolving the DID of the Issuer and checking its digital signature.</p>
<p><strong>Request body</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>json</td>
<td>The credential in JWT format</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Reply</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>payload</strong></td>
<td>json</td>
<td>The JSON object with the verified claims in the JWT</td>
</tr>
</tbody>
</table>
<p><strong>Status codes</strong></p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>200</strong></td>
<td>no error</td>
</tr>
<tr>
<td><strong>404</strong></td>
<td>error resolving the DID</td>
</tr>
</tbody>
</table>
</div></section><h1 class='nav-section-title-end'>Ended: Credentials</h1><h1 class='nav-section-title'>Trust Framework</h1><section class="print-page" id="trustframework-tf-overview"><h1 id="trustframework-tf-overview-trust-framework">Trust Framework</h1>
<h2 id="trustframework-tf-overview-introduction">Introduction</h2>
<p>The trust framework is basically composed of two things:</p>
<ol>
<li>A list of the identities of trusted organisations stored in the blockchain, together with associated information for each entity.</li>
<li>A process to add, modify and delete the trusted entities.</li>
</ol>
<p>The trust framework is designed to be largely decentralised and represents the trust relationships in the real world.</p>
<p>The identities of the juridical persons involved in the ecosystem are registered in a common directory implemented in the blockchain following a hierarchical scheme very similar to the DNS (Domain Name Service) schema in the Internet. Once an entity is registered in the system, it is completely autonomous for adding other entities that are managed as child entities.</p>
<p>However, there is one centralised element: the root of trust at the top of the hierarchy should be a trusted entity in the ecosystem that is the one bootstraping the system. Typically it should be a regulatory body or a public administration.</p>
<p>The approach for a single blockchain network is described in the following figure.</p>
<figure class="figure-image">
  <img src="../trustframework/tf-overview/trustFramework.drawio.svg" alt="The Trust Framework in the blockchain">
  <figcaption>The Trust Framework in the blockchain</figcaption>
</figure>

<p>The Trust Framework in a given blockchain is not really a flat list, but a hierarchical structure, implemented as a Smart Contract:</p>
<ul>
<li>There is a special organisation which is at the root of the hierarchy. Ideally, this is a regulator, like the Central Bank of the country to manage banks, or the Ministry of Education to manage universities.</li>
<li>This root entity is responsible for registering the identities of some trusted entities. For example, in a country with several regions with autonomous competencies to manage universities, the Ministry of Education could register in the blockchain the identities of the regional institutions which are responsible for managing the universities in each of their regions.</li>
<li>Once this is done, each of the regional institutions can register the identities of dependent entities, like universities.</li>
<li>The hierarchy can have several levels. For example, a university can be big and have several organisational units with some autonomy, maybe distributed geographically. It can create sub-identities and register them as child nodes in the blockchain.</li>
</ul>
<p>Some observations about this structure:</p>
<ul>
<li>An organisation can be registered in the blockchain only because its parent entity has registered it. No other entity in the Trust Framework can have performed the registration, not even the parent of the parent entity.</li>
<li>An organisation is responsible for all its child entities, represented as child nodes in the blockchain.</li>
<li>A third party external to the framework </li>
</ul>
<h2 id="trustframework-tf-overview-creating-identities">Creating identities</h2>
<p>A new identity can only be registered as a sub-node by an existing entity already registered in the system. The API used is <strong>/api/did/v1/identifiers</strong> and its definition is the following:</p>
<div class="admonition apidoc">
<p class="admonition-title">Create an identity</p>
<p><div class="apidoc-postbox">
    <span class="apidoc-post">GET</span>
    <span class="apidoc-url">/api/did/v1/identifiers</span>
</div></p>
<p>Create an Identity anchored in the blockchain.</p>
<p><strong>Request parameters</strong></p>
<p>The body of the request is a JSON object with the following fields</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DID</strong></td>
<td>string</td>
<td>The DID to resolve into a DID Document</td>
<td>"did:elsi:VATES-B60645900"</td>
</tr>
<tr>
<td>domain_name</td>
<td>string</td>
<td>Domain name to assign in the hierarchy</td>
<td>"in2.ala"</td>
</tr>
<tr>
<td>website</td>
<td>string</td>
<td>Website of the entity</td>
<td>"www.in2.es"</td>
</tr>
<tr>
<td>commercial_name</td>
<td>string</td>
<td>Commercial name</td>
<td>"IN2 Innovating 2gether"</td>
</tr>
<tr>
<td>new_privatekey</td>
<td>PrivatekeyJWK</td>
<td>The private key of the new entity</td>
<td></td>
</tr>
<tr>
<td>parent_privatekey</td>
<td>PrivatekeyJWK</td>
<td>The private key of caller (in this case the owner of "ala")</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Example request</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;DID&quot;</span><span class="p">:</span> <span class="s2">&quot;did:elsi:VATES-B60645900&quot;</span><span class="p">,</span>
    <span class="nt">&quot;domain_name&quot;</span><span class="p">:</span> <span class="s2">&quot;in2.ala&quot;</span><span class="p">,</span>
    <span class="nt">&quot;website&quot;</span><span class="p">:</span> <span class="s2">&quot;www.in2.es&quot;</span><span class="p">,</span>
    <span class="nt">&quot;commercial_name&quot;</span><span class="p">:</span> <span class="s2">&quot;IN2 Innovating 2gether&quot;</span><span class="p">,</span>
    <span class="nt">&quot;new_privatekey&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="nt">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;secp256k1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;Dqv3jmu8VNMKXWrHkppr5473sLMzWBczRhzdSdpxDfI&quot;</span><span class="p">,</span>
        <span class="nt">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;FTiW0a4r7S2SwjL7AlFlN1yJNWF--4_x3XTTxkFbJ9o&quot;</span><span class="p">,</span>
        <span class="nt">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;MmpxbQCOZ0L9U6rLLkD_U8LRGwYEHcoN-DPnEdlpt6A&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;parent_privatekey&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="nt">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;secp256k1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;Dqv3jmu8VNMKXWrHkppr5473sLMzWBczRhzdSdpxDfI&quot;</span><span class="p">,</span>
        <span class="nt">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;NKW_0Fs4iumEegzKoOH0Trwtje1sXsG9Z1949sA8Omo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;g4B3EI0qIdlcXTn-2RpUxgVX-sxNFdqCQDD0aHztVkk&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Reply</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>payload</strong></td>
<td>json</td>
<td>The DID document associated to the input DID</td>
</tr>
</tbody>
</table>
</div>
<p>A more detailed explanation of each field in the request follows:</p>
<dl>
<dt><strong>DID</strong></dt>
<dd>is the DID of the new entity. We support ELSI DID method (ELSI_DID_Method) and AlastriaID. The DID has to be created before the call to the API with the appropriate method for the DID. In the case of ELSI this is trivial and described in the section mentioned above.</dd>
<dt><strong>domain_name</strong></dt>
<dd>the domain name for the new entity in the Trust Framework. In the example it is <code>in2.ala</code> because it will be a sub-node of the Alastria one. The new identity will be created as a child node of the existing node owned by the entity controlling the <strong>parent_privatekey</strong>. If the parent domain name specified here is not owned by the entity controlling the <strong>parent_privatekey</strong>, an error is returned and no action is taken.</dd>
<dt><strong>website</strong></dt>
<dd>the website address in the off-chain world, so other participants can look more information about the entity. This field is informational only. However, it can be used by external appications to check that the entity in th ereal world corresponds to the one registered in th eblockchain.</dd>
<dt><strong>commercial_name</strong></dt>
<dd>the name of the company as it appears in the official register of the country/region. For example, in the case of IN2 (a Spanish business), the name should be the one registered in the <a href="http://www.rmc.es/Home.aspx?lang=en">Business Registry of Spain</a>.</dd>
<dt><strong>new_privatekey</strong></dt>
<dd>is the Private Key of the new entity, in JWK format. In this case the new entity is IN2. Please make sure the server being called is highly trusted.</dd>
<dt><strong>parent_privatekey</strong></dt>
<dd>is the Private Key of the entity owning/controlling the parent node in the domain name, in JWK format. In this case the parent node is <code>ala</code>, corresponding to Alastria. Please make sure the server being called is highly trusted. Ideally, the server has to be operated by the same entity calling the API.</dd>
</dl></section><section class="print-page" id="trustframework-smart-contracts"><h1 id="trustframework-smart-contracts-smart-contracts">Smart Contracts</h1>
<p>The Trust Framework is implemented by the Smart Contracts described below.</p>
<h2 id="trustframework-smart-contracts-the-main-registry">The main registry</h2>
<dl>
<dt><strong>ENSRegistry.sol</strong></dt>
<dd>Implements the main registry and is the first contract that should be deployed.</dd>
<dt><strong>ENS.sol</strong></dt>
<dd>Defines the interfaces and is included by <code>ENSRegistry</code> and other contracts.</dd>
</dl>
<h2 id="trustframework-smart-contracts-the-resolver-contracts">The resolver contracts</h2>
<p>These contracts implement resolution of different types of information that can be registered in the blockchain.</p>
<dl>
<dt><strong>PublicResolver.sol</strong></dt>
<dd>This is the main contract and the only one that must be compiled, because all others are included.</dd>
<dt><strong>ResolverBase.sol</strong></dt>
<dd>A utility contract used by all other contracts specialised in resolving different types of information.</dd>
</dl>
<p>Inside the ''profiles'' directory we can find the specialised contracts, all of them are included by the
<code>PublicResolver.sol</code> contract.</p>
<dl>
<dt><strong>AlaDIDPublicEntityResolver.sol</strong></dt>
<dd>Registers and resolves the identities of juridical persons (businesses, institutions, etc.). It keeps the DID
and information required to build the associated DID Document. This contract registers and resolves the first
public key associated to the DID. Additional public keys are registed using the <code>AlaDIDPubkeyResolver</code> contract.</dd>
<dt><strong>AlaDIDPubkeyResolver.sol</strong></dt>
<dd>Registers and resolves the public keys associated to the DID. In reality, it is used only if the DID has more
than one public key. In the simple case where the DID has only one public key, it is registered and resolved
directly by the <code>AlaDIDPublicEntityResolver</code> contract.</dd>
<dt><strong>AlaPublicCredentialResolver.sol</strong></dt>
<dd>Registers and resolves metadata about public credentials associated to the DID. In the case of juridical persons,
they may want to register publicly available credentials (e.g. self-declarations). In general, the bulk of the
credential data should be stored off-chain, but this contract allows registering critical credential metadata,
including a tamper-resistant pointer to the actual location of the credential details.</dd>
<dt><strong>AlaTSPResolver.sol</strong></dt>
<dd>Registers and resolves special entities. It is a specialisation of <code>AlaDIDPublicEntityResolver</code> in the sense
that it is intended for registration of the Trust Service Providers (TSPs), implementing the EU TSP List of Lists
on the blockchian. It contains the associated X509 certificates for each TSP, making it very efficient to verify
digital signatures existing off-chain.</dd>
<dt><strong>NameResolver.sol</strong></dt>
<dd>It performs reverse resolution, from domain name to blockchain address. Each entity in the Trust Framework has
a domain name assigned at the moment of registration, much in the same way as it happens with standard domain
names. This contract provides a secure way to determine from the domain name the blockchain address associated
to it and then retrieve all additional information.</dd>
<dt><strong>ContentHashResolver.sol</strong></dt>
<dd>Registers and resolves Content-addressable Identifiers. It provides the ability for a DID to register pointers
to additional information that they want to make available to the public.</dd>
<dt><strong>TextResolver.sol</strong></dt>
<dd>A general registration and resolution of any text that the DID wants to store associated to its DID. The content
is free-format and can be used for almost any purpose that the DID wishes. However, being free-format means that
the actual format and semantics may not be understood by everybody.</dd>
</dl>
<h2 id="trustframework-smart-contracts-deployment-of-the-smart-contracts">Deployment of the Smart Contracts</h2>
<h3 id="trustframework-smart-contracts-compilation">Compilation</h3>
<p>Only two contracts have to be compiled: <code>ENSRegistry.sol</code> and <code>PublicResolver.sol</code>. All the others are included by these two.</p>
<h3 id="trustframework-smart-contracts-deployment">Deployment</h3>
<p>The deployment has to be performed in strict order: first <code>ENSRegistry.sol</code> and then <code>PublicResolver.sol</code>.</p>
<p>The constructor of <code>PublicResolver.sol</code> requires the deployed address of <code>ENSRegistry.sol</code>, so it can invoke its
functions when registering/resolving information.</p></section><h1 class='nav-section-title-end'>Ended: Trust Framework</h1></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2021
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.expand"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.b0710199.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.76f349be.min.js"></script>
      
        <script src="../js/print-site-instant-loading.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  
        <script type="text/javascript">
        window.addEventListener('load', function () {
            generate_toc();
        })
        </script>
        </body>
</html>